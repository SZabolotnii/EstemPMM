# –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è PMM2 –¥–ª—è —Å–µ–∑–æ–Ω–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π (SAR)

**–ê–≤—Ç–æ—Ä:** –ê–Ω–∞–ª—ñ–∑ –≤–∏–∫–æ–Ω–∞–Ω–æ 2025-11-13
**–ú–µ—Ç–∞:** –î–æ—Å–ª—ñ–¥–∏—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –º–µ—Ç–æ–¥—É –ü–æ–ª—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–æ—ó –ú–∞–∫—Å–∏–º—ñ–∑–∞—Ü—ñ—ó (PMM2) –Ω–∞ —Å–µ–∑–æ–Ω–Ω—ñ –∞–≤—Ç–æ—Ä–µ–≥—Ä–µ—Å—ñ–π–Ω—ñ –º–æ–¥–µ–ª—ñ

---

## 1. –ü–æ—Ç–æ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è AR –º–æ–¥–µ–ª–µ–π —É –ø–∞–∫–µ—Ç—ñ EstemPMM

### 1.1 –ó–≤–∏—á–∞–π–Ω–∞ AR(p) –º–æ–¥–µ–ª—å

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∞ —Ñ–æ—Ä–º–∞:**
```
y_t = œÜ‚ÇÅ¬∑y_{t-1} + œÜ‚ÇÇ¬∑y_{t-2} + ... + œÜ_p¬∑y_{t-p} + Œº + Œµ_t
```

**Design matrix –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è:**
```r
create_ar_matrix <- function(x, p) {
  # –°—Ç–≤–æ—Ä—é—î –º–∞—Ç—Ä–∏—Ü—é —Ä–æ–∑–º—ñ—Ä—É (n-p) √ó p
  # –ö–æ–∂–µ–Ω —Å—Ç–æ–≤–ø–µ—Ü—å i –º—ñ—Å—Ç–∏—Ç—å: x[p-i+1], x[p-i+2], ..., x[n-i]
  M[, i] <- x[(p - i + 1):(n - i)]  # –õ–∞–≥ –Ω–∞ i –ø–æ–∑–∏—Ü—ñ–π
}
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ design matrix –¥–ª—è AR(3):**
```
    [lag1]  [lag2]  [lag3]
t=4:  x‚ÇÉ      x‚ÇÇ      x‚ÇÅ
t=5:  x‚ÇÑ      x‚ÇÉ      x‚ÇÇ
t=6:  x‚ÇÖ      x‚ÇÑ      x‚ÇÉ
...
t=n:  x_{n-1} x_{n-2} x_{n-3}
```

### 1.2 PMM2 –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è AR

**–ö—Ä–æ–∫ 1:** –ü–æ—á–∞—Ç–∫–æ–≤–µ –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (OLS, Yule-Walker)
```r
X <- create_ar_matrix(x_centered, p)
y <- x[(p + 1):n]
Œ≤_init <- solve(t(X) %*% X) %*% t(X) %*% y
```

**–ö—Ä–æ–∫ 2:** –û–±—á–∏—Å–ª–µ–Ω–Ω—è –º–æ–º–µ–Ω—Ç—ñ–≤ –∑ –∑–∞–ª–∏—à–∫—ñ–≤
```r
residuals <- y - X %*% Œ≤_init
moments <- compute_moments(residuals)  # m2, m3, m4
```

**–ö—Ä–æ–∫ 3:** –Ü—Ç–µ—Ä–∞—Ç–∏–≤–Ω–∞ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è PMM2
```r
Œ≤_pmm2 <- pmm2_algorithm(Œ≤_init, X, y, m2, m3, m4, ...)
```

---

## 2. –°–µ–∑–æ–Ω–Ω–∞ –∞–≤—Ç–æ—Ä–µ–≥—Ä–µ—Å—ñ–π–Ω–∞ –º–æ–¥–µ–ª—å SAR(P)_s

### 2.1 –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è

**SAR(P) –∑ —Å–µ–∑–æ–Ω–Ω–∏–º –ø–µ—Ä—ñ–æ–¥–æ–º s:**
```
y_t = Œ¶‚ÇÅ¬∑y_{t-s} + Œ¶‚ÇÇ¬∑y_{t-2s} + ... + Œ¶_P¬∑y_{t-Ps} + Œµ_t
```

**–ü—Ä–∏–∫–ª–∞–¥–∏ —Å–µ–∑–æ–Ω–Ω–∏—Ö –ø–µ—Ä—ñ–æ–¥—ñ–≤:**
- –ú—ñ—Å—è—á–Ω—ñ –¥–∞–Ω—ñ –∑ —Ä—ñ—á–Ω–æ—é —Å–µ–∑–æ–Ω–Ω—ñ—Å—Ç—é: s = 12
- –ö–≤–∞—Ä—Ç–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ: s = 4
- –¢–∏–∂–Ω–µ–≤—ñ –¥–∞–Ω—ñ –∑ —Ä—ñ—á–Ω–æ—é —Å–µ–∑–æ–Ω–Ω—ñ—Å—Ç—é: s = 52
- –î–µ–Ω–Ω—ñ –¥–∞–Ω—ñ –∑ —Ç–∏–∂–Ω–µ–≤–æ—é —Å–µ–∑–æ–Ω–Ω—ñ—Å—Ç—é: s = 7

### 2.2 –ö–æ–º–±—ñ–Ω–æ–≤–∞–Ω–∞ –º–æ–¥–µ–ª—å AR(p) √ó SAR(P)_s

**–ü–æ–≤–Ω–∞ –º–æ–¥–µ–ª—å (–Ω–µ—Å–µ–∑–æ–Ω–Ω–∞ + —Å–µ–∑–æ–Ω–Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞):**
```
y_t = œÜ‚ÇÅ¬∑y_{t-1} + ... + œÜ_p¬∑y_{t-p}
      + Œ¶‚ÇÅ¬∑y_{t-s} + ... + Œ¶_P¬∑y_{t-Ps}
      + Œº + Œµ_t
```

**–ú—É–ª—å—Ç–∏–ø–ª—ñ–∫–∞—Ç–∏–≤–Ω–∞ —Ñ–æ—Ä–º–∞ (–±—ñ–ª—å—à –∫–æ–º–ø–∞–∫—Ç–Ω–∞):**
```
Œ¶(B^s)¬∑œÜ(B)¬∑y_t = Œµ_t
```
–¥–µ:
- œÜ(B) = 1 - œÜ‚ÇÅB - ... - œÜ_pB^p (–Ω–µ—Å–µ–∑–æ–Ω–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞)
- Œ¶(B^s) = 1 - Œ¶‚ÇÅB^s - ... - Œ¶_PB^(Ps) (—Å–µ–∑–æ–Ω–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞)
- B - –æ–ø–µ—Ä–∞—Ç–æ—Ä –∑—Å—É–≤—É –Ω–∞–∑–∞–¥

**–†–æ–∑–≥–æ—Ä–Ω—É—Ç–∞ —Ñ–æ—Ä–º–∞ –¥–ª—è AR(1)√óSAR(1)‚ÇÅ‚ÇÇ:**
```
y_t = œÜ‚ÇÅ¬∑y_{t-1} + Œ¶‚ÇÅ¬∑y_{t-12} - œÜ‚ÇÅ¬∑Œ¶‚ÇÅ¬∑y_{t-13} + Œµ_t
```
‚ö†Ô∏è **–í–∞–∂–ª–∏–≤–æ:** –ó'—è–≤–ª—è—î—Ç—å—Å—è –∫—Ä–æ—Å—Å-—Ç–µ—Ä–º—ñ–Ω y_{t-13} = y_{t-1-12}

---

## 3. Design matrix –¥–ª—è SAR –º–æ–¥–µ–ª–µ–π

### 3.1 –ü—Ä–æ—Å—Ç–∞ SAR(1)‚ÇÅ‚ÇÇ –º–æ–¥–µ–ª—å

**–ú–æ–¥–µ–ª—å:**
```
y_t = Œ¶‚ÇÅ¬∑y_{t-12} + Œµ_t
```

**Design matrix –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è:**
```r
create_sar_matrix <- function(x, P, s) {
  n <- length(x)
  # –ü–æ—Ç—Ä—ñ–±–Ω–æ —è–∫ –º—ñ–Ω—ñ–º—É–º P*s —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å –¥–ª—è –ª–∞–≥—ñ–≤
  if (n <= P*s) stop("Insufficient data")

  nr <- n - P*s  # –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤
  M <- matrix(0, nr, P)

  for (i in seq_len(P)) {
    lag <- i * s  # –°–µ–∑–æ–Ω–Ω–∏–π –ª–∞–≥: s, 2s, 3s, ...
    M[, i] <- x[(P*s - lag + 1):(n - lag)]
  }

  return(M)
}
```

**–ü—Ä–∏–∫–ª–∞–¥ –¥–ª—è SAR(2)‚ÇÑ (–∫–≤–∞—Ä—Ç–∞–ª—å–Ω—ñ –¥–∞–Ω—ñ):**
```
    [lag_s=4]  [lag_2s=8]
t=9:   x‚ÇÖ         x‚ÇÅ
t=10:  x‚ÇÜ         x‚ÇÇ
t=11:  x‚Çá         x‚ÇÉ
...
t=n:   x_{n-4}    x_{n-8}
```

### 3.2 –ö–æ–º–±—ñ–Ω–æ–≤–∞–Ω–∞ –º–æ–¥–µ–ª—å AR(p) + SAR(P)_s

**–î–ª—è AR(2) √ó SAR(1)‚ÇÅ‚ÇÇ:**
```r
create_ar_sar_matrix <- function(x, p, P, s) {
  n <- length(x)
  max_lag <- max(p, P*s)

  nr <- n - max_lag
  ncol <- p + P  # –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
  M <- matrix(0, nr, ncol)

  # –ù–µ—Å–µ–∑–æ–Ω–Ω—ñ –ª–∞–≥–∏
  for (i in seq_len(p)) {
    M[, i] <- x[(max_lag - i + 1):(n - i)]
  }

  # –°–µ–∑–æ–Ω–Ω—ñ –ª–∞–≥–∏
  for (j in seq_len(P)) {
    lag <- j * s
    M[, p + j] <- x[(max_lag - lag + 1):(n - lag)]
  }

  return(M)
}
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è AR(2) √ó SAR(1)‚ÇÑ:**
```
    [lag1]  [lag2]  [lag4]
t=5:  x‚ÇÑ      x‚ÇÉ      x‚ÇÅ
t=6:  x‚ÇÖ      x‚ÇÑ      x‚ÇÇ
t=7:  x‚ÇÜ      x‚ÇÖ      x‚ÇÉ
...
```

### 3.3 –ü–æ–≤–Ω–∞ –º—É–ª—å—Ç–∏–ø–ª—ñ–∫–∞—Ç–∏–≤–Ω–∞ –º–æ–¥–µ–ª—å

**AR(1) √ó SAR(1)‚ÇÅ‚ÇÇ —Ä–æ–∑–≥–æ—Ä–Ω—É—Ç–∞:**
```
y_t = œÜ‚ÇÅ¬∑y_{t-1} + Œ¶‚ÇÅ¬∑y_{t-12} - œÜ‚ÇÅ¬∑Œ¶‚ÇÅ¬∑y_{t-13} + Œµ_t
```

**Design matrix –º–∞—î –≤–∫–ª—é—á–∞—Ç–∏ –∫—Ä–æ—Å—Å-—Ç–µ—Ä–º:**
```r
create_multiplicative_sar_matrix <- function(x, p, P, s) {
  # –ë–∞–∑–æ–≤–∞ –º–∞—Ç—Ä–∏—Ü—è –∑ AR —Ç–∞ SAR —Ç–µ—Ä–º–∞–º–∏
  M_base <- create_ar_sar_matrix(x, p, P, s)

  # –î–æ–¥–∞—Ç–∏ –∫—Ä–æ—Å—Å-—Ç–µ—Ä–º–∏ (–≤–∑–∞—î–º–æ–¥—ñ—ó)
  # –î–ª—è AR(i) —Ç–∞ SAR(j): –ø–æ—Ç—Ä—ñ–±–µ–Ω –ª–∞–≥ –Ω–∞ (i + j*s)
  n_cross <- p * P
  n <- length(x)
  max_lag <- max(p, P*s) + p  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π –º–æ–∂–ª–∏–≤–∏–π –ª–∞–≥

  nr <- n - max_lag
  M_cross <- matrix(0, nr, n_cross)

  col_idx <- 1
  for (i in seq_len(p)) {
    for (j in seq_len(P)) {
      cross_lag <- i + j*s
      M_cross[, col_idx] <- x[(max_lag - cross_lag + 1):(n - cross_lag)]
      col_idx <- col_idx + 1
    }
  }

  # –û–±'—î–¥–Ω–∞—Ç–∏ –±–∞–∑–æ–≤—ñ —Ç–µ—Ä–º–∏ —Ç–∞ –∫—Ä–æ—Å—Å-—Ç–µ—Ä–º–∏
  M_full <- cbind(M_base, M_cross)
  return(M_full)
}
```

‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º–∞:** –ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –∑—Ä–æ—Å—Ç–∞—î —à–≤–∏–¥–∫–æ:
- AR(p) √ó SAR(P)_s: p + P + p¬∑P –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
- AR(2) √ó SAR(2)‚ÇÅ‚ÇÇ: 2 + 2 + 4 = 8 –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤

---

## 4. –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è PMM2 –¥–æ SAR –º–æ–¥–µ–ª–µ–π

### 4.1 –ê–ª–≥–æ—Ä–∏—Ç–º—ñ—á–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–∞–Ω–∞–ª–æ–≥—ñ—á–Ω–∞ –¥–æ AR)

**–ö—Ä–æ–∫ 1: –ü–æ—á–∞—Ç–∫–æ–≤–µ –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è**
```r
# –í–∏–±—ñ—Ä –ø—ñ–¥—Ö–æ–¥—É:
# 1) –ê–¥–∏—Ç–∏–≤–Ω–∏–π (–ø—Ä–æ—Å—Ç—ñ—à–∏–π): AR(p) + SAR(P)_s –±–µ–∑ –∫—Ä–æ—Å—Å-—Ç–µ—Ä–º—ñ–≤
# 2) –ú—É–ª—å—Ç–∏–ø–ª—ñ–∫–∞—Ç–∏–≤–Ω–∏–π (–ø–æ–≤–Ω–∏–π): –∑ –∫—Ä–æ—Å—Å-—Ç–µ—Ä–º–∞–º–∏

# –ê–¥–∏—Ç–∏–≤–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥:
X <- create_ar_sar_matrix(x_centered, p, P, s)
y <- x[(max_lag + 1):n]
Œ≤_init <- solve(t(X) %*% X) %*% t(X) %*% y

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ arima() –∑ –º–µ—Ç–æ–¥–æ–º CSS
init_fit <- arima(x, order=c(p,0,0),
                  seasonal=list(order=c(P,0,0), period=s),
                  method="CSS")
Œ≤_init <- coef(init_fit)
```

**–ö—Ä–æ–∫ 2: –û–±—á–∏—Å–ª–µ–Ω–Ω—è –º–æ–º–µ–Ω—Ç—ñ–≤**
```r
residuals <- y - X %*% Œ≤_init
moments <- compute_moments(residuals)
```

**–ö—Ä–æ–∫ 3: PMM2 –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è**
```r
# –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ç–æ–π —Å–∞–º–∏–π pmm2_algorithm()!
Œ≤_sar_pmm2 <- pmm2_algorithm(
  b_init = Œ≤_init,
  X = X,
  y = y,
  m2 = moments$m2,
  m3 = moments$m3,
  m4 = moments$m4,
  max_iter = 50,
  tol = 1e-6
)
```

### 4.2 –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–µ –æ–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è

**–ß–æ–º—É PMM2 –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è SAR?**

1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª—ñ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –ª—ñ–Ω—ñ–π–Ω–æ—é:**
   ```
   y = X¬∑Œ≤ + Œµ
   ```
   –ù–µ–∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–æ–≥–æ, –∑–≤–∏—á–∞–π–Ω—ñ –ª–∞–≥–∏ —á–∏ —Å–µ–∑–æ–Ω–Ω—ñ - —Ü–µ –≤—Å–µ —â–µ –ª—ñ–Ω—ñ–π–Ω–∞ —Ä–µ–≥—Ä–µ—Å—ñ—è!

2. **–ü—Ä–∏–ø—É—â–µ–Ω–Ω—è –ø—Ä–æ –ø–æ—Ö–∏–±–∫–∏:**
   - SAR –º–æ–¥–µ–ª—ñ —Ç–∞–∫–æ–∂ –ø—Ä–∏–ø—É—Å–∫–∞—é—Ç—å, —â–æ Œµ_t ~ iid –∑ –ø–µ–≤–Ω–∏–º —Ä–æ–∑–ø–æ–¥—ñ–ª–æ–º
   - –Ø–∫—â–æ Œµ_t –º–∞—î –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª ‚Üí PMM2 –º–æ–∂–µ –¥–∞—Ç–∏ –∫—Ä–∞—â—ñ –æ—Ü—ñ–Ω–∫–∏
   - –¢–∏–ø–æ–≤—ñ –≤–∏–ø–∞–¥–∫–∏: –µ–∫–æ–Ω–æ–º—ñ—á–Ω—ñ —Ä—è–¥–∏ –∑ –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–º–∏ —à–æ–∫–∞–º–∏

3. **–ü–æ–ª—ñ–Ω–æ–º—ñ–∞–ª—å–Ω–∏–π –∫—Ä–∏—Ç–µ—Ä—ñ–π PMM2:**
   ```
   Z‚ÇÅ(Œ≤) = A¬∑≈∑¬≤ + B¬∑≈∑ + C
   –¥–µ A = m‚ÇÉ, B = m‚ÇÑ - m‚ÇÇ¬≤ - 2m‚ÇÉ¬∑y, C = m‚ÇÉ¬∑y¬≤ - (m‚ÇÑ-m‚ÇÇ¬≤)¬∑y - m‚ÇÇ¬∑m‚ÇÉ
   ```
   - –¶–µ–π –∫—Ä–∏—Ç–µ—Ä—ñ–π –Ω–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ X (–ª–∞–≥–∏ –∑–≤–∏—á–∞–π–Ω—ñ —á–∏ —Å–µ–∑–æ–Ω–Ω—ñ)
   - –ü—Ä–∞—Ü—é—î –æ–¥–Ω–∞–∫–æ–≤–æ –¥–ª—è –±—É–¥—å-—è–∫–æ—ó –ª—ñ–Ω—ñ–π–Ω–æ—ó –º–æ–¥–µ–ª—ñ

4. **–ó–±—ñ–∂–Ω—ñ—Å—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—É:**
   - –Ü—Ç–µ—Ä–∞—Ü—ñ–π–Ω–∞ –ø—Ä–æ—Ü–µ–¥—É—Ä–∞ PMM2 —Ä–æ–∑–≤'—è–∑—É—î —Å–∏—Å—Ç–µ–º—É —Ä—ñ–≤–Ω—è–Ω—å
   - –ó–±—ñ–∂–Ω—ñ—Å—Ç—å –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –æ–±—É–º–æ–≤–ª–µ–Ω–æ—Å—Ç—ñ X'X
   - –°–µ–∑–æ–Ω–Ω—ñ –ª–∞–≥–∏ –º–æ–∂—É—Ç—å –º–∞—Ç–∏ –≤–∏—â—É –∫–æ—Ä–µ–ª—è—Ü—ñ—é –º—ñ–∂ —Å–æ–±–æ—é (–ø—Ä–æ–±–ª–µ–º–∞?)

### 4.3 –ü–æ—Ç–µ–Ω—Ü—ñ–π–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏

**1) –ú—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω—ñ—Å—Ç—å —Å–µ–∑–æ–Ω–Ω–∏—Ö –ª–∞–≥—ñ–≤:**
- y_{t-12} —Ç–∞ y_{t-24} –º–æ–∂—É—Ç—å –±—É—Ç–∏ –≤–∏—Å–æ–∫–æ –∫–æ—Ä–µ–ª—å–æ–≤–∞–Ω—ñ
- –ü–æ–≥—ñ—Ä—à—É—î –æ–±—É–º–æ–≤–ª–µ–Ω—ñ—Å—Ç—å –º–∞—Ç—Ä–∏—Ü—ñ X'X
- **–†—ñ—à–µ–Ω–Ω—è:** –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü—ñ—è (–≤–∂–µ —î –≤ pmm2_algorithm)

**2) –î–æ–≤–∂–∏–Ω–∞ —Ä—è–¥—É:**
- –î–ª—è SAR(P)_s –ø–æ—Ç—Ä—ñ–±–Ω–æ n > P¬∑s —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω—å
- SAR(2)‚ÇÅ‚ÇÇ: –º—ñ–Ω—ñ–º—É–º 24 —Å–ø–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–Ω—è (2 —Ä–æ–∫–∏ –º—ñ—Å—è—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö)
- **–û–±–º–µ–∂–µ–Ω–Ω—è:** –ù–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –∫–æ—Ä–æ—Ç–∫–∏—Ö —Ä—è–¥—ñ–≤

**3) –ú—É–ª—å—Ç–∏–ø–ª—ñ–∫–∞—Ç–∏–≤–Ω—ñ —Ç–µ—Ä–º–∏:**
- –ö—Ä–æ—Å—Å-—Ç–µ—Ä–º–∏ –∑–±—ñ–ª—å—à—É—é—Ç—å –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
- AR(2)√óSAR(1)‚ÇÅ‚ÇÇ: 2 + 1 + 2 = 5 –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ (manageable)
- AR(3)√óSAR(2)‚ÇÅ‚ÇÇ: 3 + 2 + 6 = 11 –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ (—Å–∫–ª–∞–¥–Ω—ñ—à–µ)
- **–†—ñ—à–µ–Ω–Ω—è:** –ü–æ—á–∞—Ç–∏ –∑ –∞–¥–∏—Ç–∏–≤–Ω–æ—ó –º–æ–¥–µ–ª—ñ (–ø—Ä–æ—Å—Ç—ñ—à–µ)

**4) –°—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω—ñ—Å—Ç—å:**
- –ö–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ SAR –ø–æ–≤–∏–Ω–Ω—ñ –∑–∞–¥–æ–≤–æ–ª—å–Ω—è—Ç–∏ —É–º–æ–≤–∏ —Å—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω–æ—Å—Ç—ñ
- Œ¶(z) = 0 –º–∞—î –∫–æ—Ä–µ–Ω—ñ –ø–æ–∑–∞ –æ–¥–∏–Ω–∏—á–Ω–∏–º –∫–æ–ª–æ–º
- **–ü–æ—Ç—Ä–µ–±–∞:** –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω–æ—Å—Ç—ñ –ø—ñ—Å–ª—è –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è

---

## 5. –¢–µ–æ—Ä–µ—Ç–∏—á–Ω—ñ –ø–µ—Ä–µ–≤–∞–≥–∏ PMM2 –¥–ª—è SAR

### 5.1 –ö–æ–ª–∏ PMM2 –±—É–¥–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–∏–º?

**–í–∏–ø–∞–¥–æ–∫ 1: –ê—Å–∏–º–µ—Ç—Ä–∏—á–Ω—ñ —Å–µ–∑–æ–Ω–Ω—ñ —à–æ–∫–∏**
```
–ü—Ä–∏–∫–ª–∞–¥: –ü—Ä–æ–¥–∞–∂—ñ —Ç–æ–≤–∞—Ä—ñ–≤ –∑ –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–º–∏ –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è–º–∏
- –ü–æ–∑–∏—Ç–∏–≤–Ω—ñ —Å–µ–∑–æ–Ω–Ω—ñ —à–æ–∫–∏ (—Ä—ñ–∑–∫–µ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—è –ø–æ–ø–∏—Ç—É) > –Ω–µ–≥–∞—Ç–∏–≤–Ω—ñ
- –†–æ–∑–ø–æ–¥—ñ–ª –ø–æ—Ö–∏–±–æ–∫ –º–∞—î –ø—Ä–∞–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—é –∞—Å–∏–º–µ—Ç—Ä—ñ—é
- PMM2 –≤—Ä–∞—Ö–æ–≤—É—î m‚ÇÉ (–∞—Å–∏–º–µ—Ç—Ä—ñ—é) ‚Üí –∫—Ä–∞—â—ñ –æ—Ü—ñ–Ω–∫–∏
```

**–í–∏–ø–∞–¥–æ–∫ 2: –í–∞–∂–∫—ñ —Ö–≤–æ—Å—Ç–∏ –≤ —Å–µ–∑–æ–Ω–Ω–∏—Ö —Ä—è–¥–∞—Ö**
```
–ü—Ä–∏–∫–ª–∞–¥: –ï–Ω–µ—Ä–≥–æ—Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –∑ –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∏–º–∏ –ø–æ–≥–æ–¥–Ω–∏–º–∏ –ø–æ–¥—ñ—è–º–∏
- –†—ñ–¥–∫—ñ—Å–Ω—ñ –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ñ –∑–∏–º–∏/–ª—ñ—Ç–∞
- –†–æ–∑–ø–æ–¥—ñ–ª –º–∞—î –≤–∏—Å–æ–∫–∏–π –µ–∫—Å—Ü–µ—Å (m‚ÇÑ –≤–µ–ª–∏–∫–∏–π)
- PMM2 –≤—Ä–∞—Ö–æ–≤—É—î m‚ÇÑ ‚Üí –±—ñ–ª—å—à —Å—Ç—ñ–π–∫—ñ –æ—Ü—ñ–Ω–∫–∏
```

**–í–∏–ø–∞–¥–æ–∫ 3: –ï–∫–æ–Ω–æ–º—ñ—á–Ω—ñ —á–∞—Å–æ–≤—ñ —Ä—è–¥–∏**
```
–ü—Ä–∏–∫–ª–∞–¥: –Ü–Ω—Ñ–ª—è—Ü—ñ—è, –±–µ–∑—Ä–æ–±—ñ—Ç—Ç—è, –ø—Ä–æ–¥–∞–∂—ñ
- –ß–∞—Å—Ç–æ –º–∞—é—Ç—å –Ω–µ—Å–∏–º–µ—Ç—Ä–∏—á–Ω—ñ —Ä–æ–∑–ø–æ–¥—ñ–ª–∏
- –°–µ–∑–æ–Ω–Ω—ñ—Å—Ç—å + –∞—Å–∏–º–µ—Ç—Ä—ñ—è = —ñ–¥–µ–∞–ª—å–Ω–∏–π –∫–µ–π—Å –¥–ª—è PMM2
```

### 5.2 –û—á—ñ–∫—É–≤–∞–Ω–µ –∑–º–µ–Ω—à–µ–Ω–Ω—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó

**–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∏–π –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç:**
```
g = 1 - c‚ÇÉ¬≤/(2 + c‚ÇÑ)

–¥–µ c‚ÇÉ = m‚ÇÉ/m‚ÇÇ^(3/2) (–∞—Å–∏–º–µ—Ç—Ä—ñ—è)
   c‚ÇÑ = m‚ÇÑ/m‚ÇÇ¬≤ - 3  (–µ–∫—Å—Ü–µ—Å)
```

**–û—á—ñ–∫—É–≤–∞–Ω–Ω—è –¥–ª—è SAR:**
- –Ø–∫—â–æ —ñ–Ω–Ω–æ–≤–∞—Ü—ñ—ó –º–∞—é—Ç—å c‚ÇÉ ‚â† 0 ‚Üí g < 1 ‚Üí Var(PMM2) < Var(OLS)
- –¢–∏–ø–æ–≤—ñ –µ–∫–æ–Ω–æ–º—ñ—á–Ω—ñ —Ä—è–¥–∏: c‚ÇÉ ‚àà [0.5, 2.0]
- –û—á—ñ–∫—É–≤–∞–Ω–µ –∑–º–µ–Ω—à–µ–Ω–Ω—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó: 10-40%

---

## 6. –ü–ª–∞–Ω —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó SAR-PMM2 —É –ø–∞–∫–µ—Ç—ñ EstemPMM

### 6.1 –§–∞–∑–∞ 1: –ü—Ä–æ—Å—Ç–∞ SAR –º–æ–¥–µ–ª—å (–∞–¥–∏—Ç–∏–≤–Ω–∞)

**–ù–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è:**
```r
sar_pmm2 <- function(x, order = c(0, 1), season = list(period = 12),
                     method = "pmm2", include.mean = TRUE, ...) {
  # order = c(p, P): –Ω–µ—Å–µ–∑–æ–Ω–Ω–∏–π –ø–æ—Ä—è–¥–æ–∫ p, —Å–µ–∑–æ–Ω–Ω–∏–π –ø–æ—Ä—è–¥–æ–∫ P
  # season = list(period = s): —Å–µ–∑–æ–Ω–Ω–∏–π –ø–µ—Ä—ñ–æ–¥
}
```

**–ú–æ–¥–µ–ª—å:**
```
y_t = œÜ‚ÇÅ¬∑y_{t-1} + ... + œÜ_p¬∑y_{t-p} + Œ¶‚ÇÅ¬∑y_{t-s} + ... + Œ¶_P¬∑y_{t-Ps} + Œµ_t
```

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
1. –°—Ç–≤–æ—Ä–∏—Ç–∏ `create_sar_matrix()` –≤ `pmm2_ts_design.R`
2. –î–æ–¥–∞—Ç–∏ `sar_pmm2()` –≤ `pmm2_ts_main.R`
3. –°—Ç–≤–æ—Ä–∏—Ç–∏ S4 –∫–ª–∞—Å `SARPMM2` (extends `TS2fit`)
4. –î–æ–¥–∞—Ç–∏ –º–µ—Ç–æ–¥–∏: `coef()`, `fitted()`, `predict()`, `summary()`

### 6.2 –§–∞–∑–∞ 2: –ü–æ–≤–Ω–∞ SARIMA –º–æ–¥–µ–ª—å

**–†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–æ SARIMA(p,d,q)√ó(P,D,Q)_s:**
```r
sarima_pmm2 <- function(x,
                        order = c(0, 0, 0),      # (p, d, q)
                        seasonal = c(0, 0, 0),    # (P, D, Q)
                        period = 12,
                        method = "pmm2", ...)
```

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏:**
- p: –Ω–µ—Å–µ–∑–æ–Ω–Ω–∏–π AR –ø–æ—Ä—è–¥–æ–∫
- d: –Ω–µ—Å–µ–∑–æ–Ω–Ω–µ –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ—é–≤–∞–Ω–Ω—è
- q: –Ω–µ—Å–µ–∑–æ–Ω–Ω–∏–π MA –ø–æ—Ä—è–¥–æ–∫
- P: —Å–µ–∑–æ–Ω–Ω–∏–π AR –ø–æ—Ä—è–¥–æ–∫
- D: —Å–µ–∑–æ–Ω–Ω–µ –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ—é–≤–∞–Ω–Ω—è
- Q: —Å–µ–∑–æ–Ω–Ω–∏–π MA –ø–æ—Ä—è–¥–æ–∫
- s: —Å–µ–∑–æ–Ω–Ω–∏–π –ø–µ—Ä—ñ–æ–¥

**–°–∫–ª–∞–¥–Ω—ñ—Å—Ç—å:** –î—É–∂–µ –≤–∏—Å–æ–∫–∞ —á–µ—Ä–µ–∑ MA –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

### 6.3 –§–∞–∑–∞ 3: –ú—É–ª—å—Ç–∏–ø–ª—ñ–∫–∞—Ç–∏–≤–Ω–∞ —Ñ–æ—Ä–º–∞

**–î–æ–¥–∞—Ç–∏ –æ–ø—Ü—ñ—é –¥–ª—è –∫—Ä–æ—Å—Å-—Ç–µ—Ä–º—ñ–≤:**
```r
sar_pmm2(x, order = c(1, 1), season = list(period = 12),
         multiplicative = TRUE)  # –í–∫–ª—é—á–∏—Ç–∏ –∫—Ä–æ—Å—Å-—Ç–µ—Ä–º–∏
```

### 6.4 –î–æ–¥–∞—Ç–∫–æ–≤—ñ —É—Ç–∏–ª—ñ—Ç–∏

**–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω–æ—Å—Ç—ñ:**
```r
check_sar_stationarity <- function(ar_coef, sar_coef, period) {
  # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–æ—Ä–µ–Ω—ñ–≤ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏—á–Ω–æ–≥–æ –ø–æ–ª—ñ–Ω–æ–º–∞
}
```

**–ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –º–µ—Ç–æ–¥—ñ–≤:**
```r
compare_sar_methods <- function(x, order, period) {
  # –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è: OLS, Yule-Walker, CSS, ML, PMM2
}
```

---

## 7. –ü—Ä–∏–∫–ª–∞–¥ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è (–∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–∏–π)

### 7.1 –ú—ñ—Å—è—á–Ω—ñ –¥–∞–Ω—ñ –ø—Ä–æ–¥–∞–∂—ñ–≤

```r
# –ì–µ–Ω–µ—Ä—É—î–º–æ —Å–∏–Ω—Ç–µ—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ –∑ –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–º–∏ –ø–æ—Ö–∏–±–∫–∞–º–∏
set.seed(123)
n <- 120  # 10 —Ä–æ–∫—ñ–≤ –º—ñ—Å—è—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö
s <- 12   # –†—ñ—á–Ω–∞ —Å–µ–∑–æ–Ω–Ω—ñ—Å—Ç—å

# –°–µ–∑–æ–Ω–Ω–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ (—Å–∏–Ω—É—Å–æ—ó–¥–∞)
season_effect <- 10 * sin(2*pi*(1:n)/s)

# AR(1) –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
ar_coef <- 0.7
y <- numeric(n)
y[1] <- rnorm(1)
for(t in 2:n) {
  y[t] <- ar_coef * y[t-1] + season_effect[t] + rgamma(1, shape=2, scale=1) - 2
}

# –î–æ–¥–∞—Ç–∏ —Å–µ–∑–æ–Ω–Ω–∏–π AR –µ—Ñ–µ–∫—Ç
sar_coef <- 0.5
for(t in (s+1):n) {
  y[t] <- y[t] + sar_coef * y[t-s]
}

# –ù–æ—Ä–º–∞–ª—ñ–∑—É–≤–∞—Ç–∏
y <- (y - mean(y)) / sd(y)

# –§—ñ—Ç—É–≤–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π
library(EstemPMM)

# –ó–≤–∏—á–∞–π–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ stats::arima)
fit_standard <- arima(y, order=c(1,0,0),
                      seasonal=list(order=c(1,0,0), period=12))

# PMM2 –ø—ñ–¥—Ö—ñ–¥ (–º–∞–π–±—É—Ç–Ω—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è)
fit_pmm2 <- sar_pmm2(y, order=c(1, 1), season=list(period=12))

# –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è
compare_sar_models(fit_standard, fit_pmm2)
```

### 7.2 –û—á—ñ–∫—É–≤–∞–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏

**–Ø–∫—â–æ —ñ–Ω–Ω–æ–≤–∞—Ü—ñ—ó –º–∞—é—Ç—å –∞—Å–∏–º–µ—Ç—Ä—ñ—é:**
- PMM2 –¥–∞—Å—Ç—å –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ –∑ –º–µ–Ω—à–æ—é –¥–∏—Å–ø–µ—Ä—Å—ñ—î—é
- –ö—Ä–∞—â–∞ —Ç–æ—á–Ω—ñ—Å—Ç—å –ø—Ä–æ–≥–Ω–æ–∑—ñ–≤
- –ë—ñ–ª—å—à —Ä–µ–∞–ª—ñ—Å—Ç–∏—á–Ω—ñ –¥–æ–≤—ñ—Ä—á—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏

**–ú–µ—Ç—Ä–∏–∫–∏ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è:**
```
                   Standard ML    PMM2
AR(1) –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç:  0.685¬±0.08    0.692¬±0.06  ‚úì (-25% SE)
SAR(1) –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç: 0.482¬±0.09    0.488¬±0.07  ‚úì (-22% SE)
Skewness residuals: 0.82          0.75        ‚úì (–º–µ–Ω—à–∞ –∞—Å–∏–º–µ—Ç—Ä—ñ—è)
AIC:               -45.2         -48.6        ‚úì (–∫—Ä–∞—â–µ)
```

---

## 8. –í–∏—Å–Ω–æ–≤–∫–∏ —Ç–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó

### 8.1 –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∞ –æ–±“ë—Ä—É–Ω—Ç–æ–≤–∞–Ω—ñ—Å—Ç—å

‚úÖ **PMM2 –º–æ–∂–Ω–∞ –∑–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –¥–æ SAR –º–æ–¥–µ–ª–µ–π:**
1. –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –ª—ñ–Ω—ñ–π–Ω–æ—é —Ä–µ–≥—Ä–µ—Å—ñ—î—é
2. –ê–ª–≥–æ—Ä–∏—Ç–º PMM2 –Ω–µ –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Ç–∏–ø—É –ª–∞–≥—ñ–≤ (–∑–≤–∏—á–∞–π–Ω—ñ/—Å–µ–∑–æ–Ω–Ω—ñ)
3. –¢–µ–æ—Ä–µ—Ç–∏—á–Ω—ñ –ø–µ—Ä–µ–≤–∞–≥–∏ (–∑–º–µ–Ω—à–µ–Ω–Ω—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó) –∑–±–µ—Ä–µ–∂—É—Ç—å—Å—è –ø—Ä–∏ –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏—Ö –ø–æ—Ö–∏–±–∫–∞—Ö

‚úÖ **–ú—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–∏ –≤ –∞–ª–≥–æ—Ä–∏—Ç–º—ñ:**
- –û—Å–Ω–æ–≤–Ω–∏–π `pmm2_algorithm()` –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è –±–µ–∑ –∑–º—ñ–Ω
- –ü–æ—Ç—Ä—ñ–±–Ω–æ –ª–∏—à–µ –∞–¥–∞–ø—Ç—É–≤–∞—Ç–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é design matrix

### 8.2 –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –ø–µ—Ä–µ–≤–∞–≥–∏

**–î–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –ø–∞–∫–µ—Ç—É:**
1. –ë—ñ–ª—å—à —Ç–æ—á–Ω—ñ –æ—Ü—ñ–Ω–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ —Å–µ–∑–æ–Ω–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π
2. –ö—Ä–∞—â—ñ –ø—Ä–æ–≥–Ω–æ–∑–∏ –ø—Ä–∏ –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏—Ö —à–æ–∫–∞—Ö
3. –Ñ–¥–∏–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–ª—è AR, ARMA, ARIMA, SAR, SARIMA

**–î–ª—è —Ä–æ–∑–≤–∏—Ç–∫—É –ø–∞–∫–µ—Ç—É:**
1. –õ–æ–≥—ñ—á–Ω–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è —ñ—Å–Ω—É—é—á–æ–≥–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É
2. –í–∏–ø–æ–≤–Ω—é—î –ø—Ä–æ–≥–∞–ª–∏–Ω—É –≤ —Å–µ–∑–æ–Ω–Ω–æ–º—É –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—ñ
3. –ü—ñ–¥–≤–∏—â—É—î –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø—Ä–æ–º–æ–∂–Ω—ñ—Å—Ç—å –ø–∞–∫–µ—Ç—É

### 8.3 –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π –ø–ª–∞–Ω –¥—ñ–π

**–ö–æ—Ä–æ—Ç–∫–æ—Å—Ç—Ä–æ–∫–æ–≤–æ (1-2 —Ç–∏–∂–Ω—ñ):**
1. ‚úÖ –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ `create_sar_matrix()` –¥–ª—è –ø—Ä–æ—Å—Ç–æ—ó SAR –º–æ–¥–µ–ª—ñ
2. ‚úÖ –î–æ–¥–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é `sar_pmm2()` –∑ –∞–¥–∏—Ç–∏–≤–Ω–æ—é —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—î—é
3. ‚úÖ –°—Ç–≤–æ—Ä–∏—Ç–∏ S4 –∫–ª–∞—Å `SARPMM2` –∑ –±–∞–∑–æ–≤–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
4. ‚úÖ –ù–∞–ø–∏—Å–∞—Ç–∏ unit tests –¥–ª—è SAR —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É
5. ‚úÖ –î–æ–¥–∞—Ç–∏ –¥–µ–º–æ-—Å–∫—Ä–∏–ø—Ç –∑ —Å–∏–Ω—Ç–µ—Ç–∏—á–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏

**–°–µ—Ä–µ–¥–Ω—å–æ—Å—Ç—Ä–æ–∫–æ–≤–æ (1-2 –º—ñ—Å—è—Ü—ñ):**
1. üìã –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–æ–≤–Ω—É SARIMA –º–æ–¥–µ–ª—å
2. üìã –î–æ–¥–∞—Ç–∏ –º—É–ª—å—Ç–∏–ø–ª—ñ–∫–∞—Ç–∏–≤–Ω—É —Ñ–æ—Ä–º—É (–∑ –∫—Ä–æ—Å—Å-—Ç–µ—Ä–º–∞–º–∏)
3. üìã –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –¥–ª—è SAR –º–æ–¥–µ–ª–µ–π
4. üìã Bootstrap —ñ–Ω—Ñ–µ—Ä–µ–Ω—Ü—ñ—è –¥–ª—è SAR
5. üìã –ù–∞–ø–∏—Å–∞—Ç–∏ –≤—ñ–Ω—å—î—Ç–∫—É "Seasonal Models with PMM2"

**–î–æ–≤–≥–æ—Å—Ç—Ä–æ–∫–æ–≤–æ (3-6 –º—ñ—Å—è—Ü—ñ–≤):**
1. üìã –ü–æ—Ä—ñ–≤–Ω—è–ª—å–Ω—ñ Monte Carlo —Å–∏–º—É–ª—è—Ü—ñ—ó SAR vs ARIMA
2. üìã –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –¥–æ —Ä–µ–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö (–µ–Ω–µ—Ä–≥–æ—Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è, –ø—Ä–æ–¥–∞–∂—ñ)
3. üìã –ü—É–±–ª—ñ–∫–∞—Ü—ñ—è —Å—Ç–∞—Ç—Ç—ñ –ø—Ä–æ PMM2 –¥–ª—è —Å–µ–∑–æ–Ω–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π
4. üìã Submission –¥–æ CRAN –∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–∏–º —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª–æ–º

### 8.4 –û—á—ñ–∫—É–≤–∞–Ω—ñ –≤–∏–∫–ª–∏–∫–∏

‚ö†Ô∏è **–¢–µ—Ö–Ω—ñ—á–Ω—ñ:**
1. –ú—É–ª—å—Ç–∏–∫–æ–ª—ñ–Ω–µ–∞—Ä–Ω—ñ—Å—Ç—å —Å–µ–∑–æ–Ω–Ω–∏—Ö –ª–∞–≥—ñ–≤
2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ü—ñ–æ–Ω–∞—Ä–Ω–æ—Å—Ç—ñ —Å–∫–ª–∞–¥–Ω—ñ—à–∞ –¥–ª—è SAR
3. –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –ø–æ—Ç—Ä–µ–±—É—î —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å

‚ö†Ô∏è **–û–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω—ñ:**
1. –ë—ñ–ª—å—à—ñ design matrices ‚Üí –ø–æ–≤—ñ–ª—å–Ω—ñ—à–∞ –∑–±—ñ–∂–Ω—ñ—Å—Ç—å
2. –ü–æ—Ç—Ä–µ–±–∞ –≤ –¥–æ–≤—à–∏—Ö —á–∞—Å–æ–≤–∏—Ö —Ä—è–¥–∞—Ö (n > P¬∑s)

‚ö†Ô∏è **–í–∞–ª—ñ–¥–∞—Ü—ñ—è:**
1. –ü–æ—Ç—Ä—ñ–±–Ω—ñ –±–µ–Ω—á–º–∞—Ä–∫–∏ –ø—Ä–æ—Ç–∏ stats::arima()
2. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –Ω–∞ —Ä–µ–∞–ª—å–Ω–∏—Ö —Å–µ–∑–æ–Ω–Ω–∏—Ö –¥–∞–Ω–∏—Ö
3. –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ —ñ–Ω—à–∏–º–∏ robust –º–µ—Ç–æ–¥–∞–º–∏

### 8.5 –§—ñ–Ω–∞–ª—å–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è

**üéØ –†–ï–ö–û–ú–ï–ù–î–£–Æ –†–û–ó–ü–û–ß–ê–¢–ò –†–ï–ê–õ–Ü–ó–ê–¶–Ü–Æ SAR-PMM2:**

**–ü—Ä–∏—á–∏–Ω–∏:**
1. ‚úÖ –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–æ –æ–±“ë—Ä—É–Ω—Ç–æ–≤–∞–Ω–æ
2. ‚úÖ –¢–µ—Ö–Ω—ñ—á–Ω–æ —Ä–µ–∞–ª—ñ–∑–æ–≤—É—î—Ç—å—Å—è –∑ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–º–∏ –∑–º—ñ–Ω–∞–º–∏
3. ‚úÖ –í–∏—Å–æ–∫–∏–π –Ω–∞—É–∫–æ–≤–∏–π –ø–æ—Ç–µ–Ω—Ü—ñ–∞–ª
4. ‚úÖ –ü—Ä–∞–∫—Ç–∏—á–Ω–∞ —Ü—ñ–Ω–Ω—ñ—Å—Ç—å –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
5. ‚úÖ –õ–æ–≥—ñ—á–Ω–µ –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è —ñ—Å–Ω—É—é—á–æ–≥–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—É

**–ü–æ—á–∞—Ç–æ–∫:**
- –°—Ç–≤–æ—Ä–∏—Ç–∏ –≥—ñ–ª–∫—É `feature/sar-models`
- –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –±–∞–∑–æ–≤—É SAR(P)_s –º–æ–¥–µ–ª—å
- –ü—Ä–æ—Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –Ω–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö –∑ –≤—ñ–¥–æ–º–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- –Ø–∫—â–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ–∑–∏—Ç–∏–≤–Ω—ñ ‚Üí –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –∑ –ø–æ–≤–Ω–æ—é SARIMA

---

**–î–∞—Ç–∞:** 2025-11-13
**–°—Ç–∞—Ç—É—Å:** –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –∑–∞–≤–µ—Ä—à–µ–Ω–æ ‚úÖ
**–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫:** –û–±–≥–æ–≤–æ—Ä–µ–Ω–Ω—è –∑ –∞–≤—Ç–æ—Ä–æ–º –ø–∞–∫–µ—Ç—É —Ç–∞ –ø—Ä–∏–π–Ω—è—Ç—Ç—è —Ä—ñ—à–µ–Ω–Ω—è –ø—Ä–æ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é
