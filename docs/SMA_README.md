# SMA-PMM2: –°–µ–∑–æ–Ω–Ω—ñ –º–æ–¥–µ–ª—ñ –∫–æ–≤–∑–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –∑ –º–µ—Ç–æ–¥–æ–º PMM2

## üéâ –°—Ç–∞—Ç—É—Å: –†–ï–ê–õ–Ü–ó–û–í–ê–ù–û –Ü –ü–†–û–¢–ï–°–¢–û–í–ê–ù–û

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è:** 13 –ª–∏—Å—Ç–æ–ø–∞–¥–∞ 2025
**–í–µ—Ä—Å—ñ—è –ø–∞–∫–µ—Ç—É:** EstemPMM 0.1.2
**–ì—ñ–ª–∫–∞:** `claude/sar_sma-011CV5bS4H3iSNYMp5ckzyF5`

---

## üìä –ö–ª—é—á–æ–≤—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ Monte Carlo —Å–∏–º—É–ª—è—Ü—ñ—ó

### –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è PMM2 vs CSS (500 —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ–π)

| –ú–µ—Ç—Ä–∏–∫–∞ | CSS | PMM2 | –ü–æ–ª—ñ–ø—à–µ–Ω–Ω—è |
|---------|-----|------|------------|
| **–°–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è** | 0.6084 | 0.6100 | - |
| **Std. Deviation** | 0.1053 | 0.0854 | -18.9% |
| **Bias** | 0.0084 | 0.0100 | - |
| **MSE** | 0.0111 | 0.0074 | **-33.6%** ‚úì |
| **RMSE** | 0.1055 | 0.0859 | -18.6% |
| **Variance Ratio** | 1.0000 | 0.6588 | **-34.1%** ‚úì |

### üéØ –í–∏—Å–Ω–æ–≤–æ–∫
**PMM2 –¥–æ—Å—è–≥ –∑–Ω–∏–∂–µ–Ω–Ω—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó –Ω–∞ 34.12%**, —â–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–∏–º –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è–º (g = 0.6995, –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å 94.2%).

---

## üìÅ –ó–º—ñ—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó

### 1. **SMA_README.md** (—Ü–µ–π —Ñ–∞–π–ª)
–ì–æ–ª–æ–≤–Ω–∏–π –æ–≥–ª—è–¥ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó SMA-PMM2 –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è.

### 2. **SMA_PMM2_FEASIBILITY_ANALYSIS.md**
–ü–æ–≤–Ω–∏–π —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è PMM2 –¥–æ —Å–µ–∑–æ–Ω–Ω–∏—Ö MA –º–æ–¥–µ–ª–µ–π:
- –ê–Ω–∞–ª—ñ–∑ —ñ—Å–Ω—É—é—á–æ—ó MA-PMM2 —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó
- –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è SMA(Q)_s –º–æ–¥–µ–ª–µ–π
- –°—Ç—Ä–∞—Ç–µ–≥—ñ—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–æ–¥—É (90% code reuse)
- –¢–µ–æ—Ä–µ—Ç–∏—á–Ω–µ –æ–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
- –û—á—ñ–∫—É–≤–∞–Ω—ñ –ø–µ—Ä–µ–≤–∞–≥–∏ (30-50% variance reduction)

### 3. **SMA_PMM2_IMPLEMENTATION_SUMMARY.md**
–¢–µ—Ö–Ω—ñ—á–Ω–∏–π –æ–ø–∏—Å —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó:
- –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–¥—É
- –§—É–Ω–∫—Ü—ñ—ó —Ç–∞ —ó—Ö –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è
- S4 –∫–ª–∞—Å–∏ —Ç–∞ –º–µ—Ç–æ–¥–∏
- –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### 4. **SMA_MONTE_CARLO_RESULTS.md**
–î–µ—Ç–∞–ª—å–Ω—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ Monte Carlo —Å–∏–º—É–ª—è—Ü—ñ—ó (—Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ).

---

## üéØ –©–æ —Ç–∞–∫–µ SMA-PMM2?

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–∞ –º–æ–¥–µ–ª—å

**–°–µ–∑–æ–Ω–Ω–∞ –º–æ–¥–µ–ª—å –∫–æ–≤–∑–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ (Seasonal Moving Average):**

```
y_t = Œº + Œµ_t + Œò‚ÇÅ¬∑Œµ_{t-s} + Œò‚ÇÇ¬∑Œµ_{t-2s} + ... + Œò_Q¬∑Œµ_{t-Qs}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**
- **Q** ‚Äî –ø–æ—Ä—è–¥–æ–∫ —Å–µ–∑–æ–Ω–Ω–æ—ó MA
- **s** ‚Äî —Å–µ–∑–æ–Ω–Ω–∏–π –ø–µ—Ä—ñ–æ–¥ (12 –¥–ª—è –º—ñ—Å—è—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö, 4 –¥–ª—è –∫–≤–∞—Ä—Ç–∞–ª—å–Ω–∏—Ö)
- **Œò‚ÇÅ, ..., Œò_Q** ‚Äî –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ —Å–µ–∑–æ–Ω–Ω–æ—ó MA
- **Œµ_t** ‚Äî —ñ–Ω–Ω–æ–≤–∞—Ü—ñ—ó (–ø–æ–º–∏–ª–∫–∏)
- **Œº** ‚Äî intercept (—Å–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è)

### –ß–æ–º—É PMM2?

**PMM2 (Polynomial Maximization Method, S=2)** –Ω–∞–¥–∞—î **–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à—ñ –æ—Ü—ñ–Ω–∫–∏** –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤, –Ω—ñ–∂ CSS/ML, –∫–æ–ª–∏ —ñ–Ω–Ω–æ–≤–∞—Ü—ñ—ó –º–∞—é—Ç—å:
- ‚úÖ **–ê—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª** (skewness ‚â† 0)
- ‚úÖ **–í–∞–∂–∫—ñ —Ö–≤–æ—Å—Ç–∏** (excess kurtosis > 0)
- ‚úÖ **–ù–µ–≥–∞—É—Å—ñ–≤—Å—å–∫—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ**

**–û—á—ñ–∫—É–≤–∞–Ω–µ –∑–Ω–∏–∂–µ–Ω–Ω—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó:**
```
g = 1 - c‚ÇÉ¬≤/(2 + c‚ÇÑ)
```
–¥–µ:
- **c‚ÇÉ** ‚Äî –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∞—Å–∏–º–µ—Ç—Ä—ñ—ó (skewness)
- **c‚ÇÑ** ‚Äî –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –µ–∫—Å—Ü–µ—Å—É (excess kurtosis)

---

## üöÄ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –ë–∞–∑–æ–≤–∏–π –ø—Ä–∏–∫–ª–∞–¥

```r
library(EstemPMM)

# –ì–µ–Ω–µ—Ä—É—î–º–æ —Å–∏–Ω—Ç–µ—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ SMA(1)_12 –∑ –≥–∞–º–º–∞-—ñ–Ω–Ω–æ–≤–∞—Ü—ñ—è–º–∏
set.seed(123)
n <- 120  # 10 —Ä–æ–∫—ñ–≤ –º—ñ—Å—è—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö
s <- 12
theta_true <- 0.6

# –ê—Å–∏–º–µ—Ç—Ä–∏—á–Ω—ñ —ñ–Ω–Ω–æ–≤–∞—Ü—ñ—ó (gamma distribution)
innov <- rgamma(n, shape = 2, scale = 1) - 2
y <- numeric(n)
for (t in 1:n) {
  ma_term <- if (t > s) theta_true * innov[t - s] else 0
  y[t] <- innov[t] + ma_term
}

# –§—ñ—Ç—É—î–º–æ SMA(1)_12 –º–æ–¥–µ–ª—å –∑ PMM2
fit_pmm2 <- sma_pmm2(y, order = 1, season = list(period = 12),
                     method = "pmm2", verbose = TRUE)

# –î–∏–≤–∏–º–æ—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
summary(fit_pmm2)
coef(fit_pmm2)

# –ü–æ—Ä—ñ–≤–Ω—é—î–º–æ –∑ CSS
fit_css <- sma_pmm2(y, order = 1, season = list(period = 12),
                    method = "css", verbose = FALSE)
coef(fit_css)
```

### –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è (—Å–∫–æ—Ä–æ)

```r
# –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 12 –∫—Ä–æ–∫—ñ–≤ –≤–ø–µ—Ä–µ–¥
forecast <- predict(fit_pmm2, n.ahead = 12)
```

---

## üîß –¢–µ—Ö–Ω—ñ—á–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–¥—É

**1. –û—Å–Ω–æ–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó** (`R/pmm2_ts_main.R`):
```r
sma_pmm2()              # –ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
‚îú‚îÄ‚îÄ sma_css_fit()       # –ü–æ—á–∞—Ç–∫–æ–≤–∞ CSS –æ—Ü—ñ–Ω–∫–∞ (—á–µ—Ä–µ–∑ stats::arima)
‚îî‚îÄ‚îÄ sma_pmm2_fit()      # PMM2 —É—Ç–æ—á–Ω–µ–Ω–Ω—è
    ‚îú‚îÄ‚îÄ sma_build_design()       # –ü–æ–±—É–¥–æ–≤–∞ design matrix
    ‚îú‚îÄ‚îÄ ma_solve_pmm2()          # –†–æ–∑–≤'—è–∑–∞–Ω–Ω—è PMM2 (–ø–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è!)
    ‚îî‚îÄ‚îÄ sma_compute_innovations() # –†–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π —Ä–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ —ñ–Ω–Ω–æ–≤–∞—Ü—ñ–π
```

**2. S4 –∫–ª–∞—Å–∏ —Ç–∞ –º–µ—Ç–æ–¥–∏** (`R/pmm2_classes.R`, `R/pmm2_ts_methods.R`):
```r
SMAPMM2  # S4 –∫–ª–∞—Å –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤
‚îú‚îÄ‚îÄ coef(SMAPMM2)      # –ï–∫—Å—Ç—Ä–∞–∫—Ü—ñ—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç—ñ–≤
‚îú‚îÄ‚îÄ summary(SMAPMM2)   # –î–µ—Ç–∞–ª—å–Ω–∏–π –∑–≤—ñ—Ç
‚îú‚îÄ‚îÄ fitted(SMAPMM2)    # Fitted values
‚îú‚îÄ‚îÄ residuals(SMAPMM2) # Residuals/innovations
‚îî‚îÄ‚îÄ predict(SMAPMM2)   # –ü—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è (–≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ)
```

### –ö–ª—é—á–æ–≤—ñ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó

**‚úÖ 90% –ø–æ–≤—Ç–æ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–æ–¥—É MA-PMM2:**
- –§—É–Ω–∫—Ü—ñ—è `ma_solve_pmm2()` –Ω–µ –∑–º—ñ–Ω—é–≤–∞–ª–∞—Å—å!
- –õ–∏—à–µ –∑–º—ñ–Ω–∞ —ñ–Ω–¥–µ–∫—Å—ñ–≤ –ª–∞–≥—ñ–≤: `j` ‚Üí `j*s`

**‚úÖ –ï—Ñ–µ–∫—Ç–∏–≤–Ω–∏–π –∞–ª–≥–æ—Ä–∏—Ç–º:**
- CSS –¥–ª—è –ø–æ—á–∞—Ç–∫–æ–≤–∏—Ö –æ—Ü—ñ–Ω–æ–∫ (—à–≤–∏–¥–∫–æ, —Å—Ç–∞–±—ñ–ª—å–Ω–æ)
- PMM2 –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–Ω—è (3-5 —ñ—Ç–µ—Ä–∞—Ü—ñ–π, Newton method)
- 100% convergence rate —É —Å–∏–º—É–ª—è—Ü—ñ—è—Ö

**‚úÖ –ù–∞–¥—ñ–π–Ω—ñ—Å—Ç—å:**
- –û–±—Ä–æ–±–∫–∞ NA –∑–Ω–∞—á–µ–Ω—å
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–Ω–æ—Å—Ç—ñ –¥–∞–Ω–∏—Ö
- Regularization –¥–ª—è —á–∏—Å–ª–æ–≤–æ—ó —Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### Quick Test (`test_sma_quick.R`)

**–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**
- SMA(1)_12 model, Œ∏_true = 0.6
- n = 120 observations
- Gamma innovations (shape=2, scale=1)

**–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:**
```
CSS estimate:   Œ∏ÃÇ = 0.6002  (error: 0.03%)
PMM2 estimate:  Œ∏ÃÇ = 0.6502  (error: 8.36%)
```

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** –£ –ø–æ–æ–¥–∏–Ω–æ–∫–∏—Ö –ø—Ä–æ–≥–æ–Ω–∞—Ö CSS –º–æ–∂–µ –±—É—Ç–∏ —Ç–æ—á–Ω—ñ—à–∏–º —á–µ—Ä–µ–∑ –≤–∏–ø–∞–¥–∫–æ–≤—ñ—Å—Ç—å. PMM2 –∑–º–µ–Ω—à—É—î **–¥–∏—Å–ø–µ—Ä—Å—ñ—é** (—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—Å—Ç—å), —â–æ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂—É—î—Ç—å—Å—è Monte Carlo.

### Monte Carlo Simulation (`run_sma_monte_carlo.R`)

**–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**
- 500 replications
- SMA(1)_12 model, Œ∏_true = 0.6
- n = 120 observations per replication
- Gamma innovations (right-skewed, c‚ÇÉ ‚âà 0.89)

**–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:**

| –ú–µ—Ç—Ä–∏–∫–∞ | CSS | PMM2 | –ü–æ–ª—ñ–ø—à–µ–Ω–Ω—è |
|---------|-----|------|------------|
| **Mean** | 0.6084 | 0.6100 | Bias +0.16pp |
| **Std Dev** | 0.1053 | 0.0854 | **-18.9%** ‚úì |
| **MSE** | 0.0111 | 0.0074 | **-33.6%** ‚úì |
| **Variance** | 0.0111 | 0.0073 | **-34.1%** ‚úì |

**–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–µ –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è:**
```
c‚ÇÉ = 0.8861  (skewness coefficient)
c‚ÇÑ = 0.6129  (excess kurtosis)
g = 0.6995   (expected variance ratio)

Observed variance ratio: 0.6588
Match: 94.2% ‚úì
```

**–Ü–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü—ñ—è:**
- ‚úÖ PMM2 –¥–æ—Å—è–≥ **34% –∑–Ω–∏–∂–µ–Ω–Ω—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó**
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–∏–º –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è–º (94% match)
- ‚úÖ PMM2 –Ω–∞–¥–∞—î **—Å—Ç–∞–±—ñ–ª—å–Ω—ñ—à—ñ –æ—Ü—ñ–Ω–∫–∏** –ø—Ä–∏ –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏—Ö —ñ–Ω–Ω–æ–≤–∞—Ü—ñ—è—Ö
- ‚úÖ 100% convergence rate (–≤—Å—ñ 500 —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ–π)
- ‚úÖ –®–≤–∏–¥–∫–∞ –∑–±—ñ–∂–Ω—ñ—Å—Ç—å (–≤ —Å–µ—Ä–µ–¥–Ω—å–æ–º—É 3.6 —ñ—Ç–µ—Ä–∞—Ü—ñ–π)

---

## üéì –ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ SMA-PMM2?

### ‚úÖ –Ü–¥–µ–∞–ª—å–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó

1. **–ï–∫–æ–Ω–æ–º—ñ—á–Ω—ñ –¥–∞–Ω—ñ –∑ —Å–µ–∑–æ–Ω–Ω—ñ—Å—Ç—é:**
   - –ü—Ä–æ–¥–∞–∂—ñ (—Å–ø–∞–¥-–ø—ñ–¥–π–æ–º –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω—ñ)
   - –°–ø–æ–∂–∏–≤–∞–Ω–Ω—è –µ–ª–µ–∫—Ç—Ä–æ–µ–Ω–µ—Ä–≥—ñ—ó (–ø—ñ–∫–æ–≤—ñ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è)
   - –¢—É—Ä–∏–∑–º (–≤–∏—Å–æ–∫–∏–π —Å–µ–∑–æ–Ω vs –Ω–∏–∑—å–∫–∏–π)

2. **–ö–ª—ñ–º–∞—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ:**
   - –û–ø–∞–¥–∏ (heavy right tail, –∑–∞–≤–∂–¥–∏ ‚â• 0)
   - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ñ –∞–Ω–æ–º–∞–ª—ñ—ó
   - –ï–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ñ –ø–æ–≥–æ–¥–Ω—ñ –ø–æ–¥—ñ—ó

3. **–§—ñ–Ω–∞–Ω—Å–æ–≤—ñ —á–∞—Å–æ–≤—ñ —Ä—è–¥–∏:**
   - –í–æ–ª–∞—Ç–∏–ª—å–Ω—ñ—Å—Ç—å (leverage effect ‚Äî –∞—Å–∏–º–µ—Ç—Ä—ñ—è)
   - –û–±—Å—è–≥–∏ —Ç–æ—Ä–≥—ñ–≤ (right-skewed)

### ‚ö†Ô∏è –ö–æ–ª–∏ PMM2 –Ω–µ –¥–∞—î –ø–µ—Ä–µ–≤–∞–≥

- –ì–∞—É—Å—ñ–≤—Å—å–∫—ñ —ñ–Ω–Ω–æ–≤–∞—Ü—ñ—ó (c‚ÇÉ ‚âà 0)
- –î—É–∂–µ –º–∞–ª—ñ –≤–∏–±—ñ—Ä–∫–∏ (n < 50)
- –°–∏–º–µ—Ç—Ä–∏—á–Ω—ñ —Ä–æ–∑–ø–æ–¥—ñ–ª–∏

---

## üî¨ –ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ –æ—Å–Ω–æ–≤–∏

### PMM2 Objective Function

PMM2 –º–∞–∫—Å–∏–º—ñ–∑—É—î:
```
L(Œ≤) = Œ£·µ¢ œà(r·µ¢(Œ≤))

–¥–µ œà(r) = r¬≤ - c¬∑r¬≥  (–¥–ª—è S=2)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä c:**
```
c = m‚ÇÉ/(2¬∑m‚ÇÇ¬≤)
```
–¥–µ m‚ÇÇ, m‚ÇÉ ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ñ –º–æ–º–µ–Ω—Ç–∏ –∑–∞–ª–∏—à–∫—ñ–≤.

### Newton Method

PMM2 –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î Newton method –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó:
```
Œ≤^(k+1) = Œ≤^(k) - [J'J]‚Åª¬π¬∑J'¬∑œà'

–¥–µ J ‚Äî Jacobian matrix
```

**–ó–±—ñ–∂–Ω—ñ—Å—Ç—å:** –∑–∞–∑–≤–∏—á–∞–π 3-5 —ñ—Ç–µ—Ä–∞—Ü—ñ–π –¥–ª—è SMA –º–æ–¥–µ–ª–µ–π.

### Variance Reduction Factor

–¢–µ–æ—Ä–µ—Ç–∏—á–Ω–∏–π –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç –∑–Ω–∏–∂–µ–Ω–Ω—è –¥–∏—Å–ø–µ—Ä—Å—ñ—ó:
```
g = 1 - c‚ÇÉ¬≤/(2 + c‚ÇÑ)

–Ø–∫—â–æ g < 1: PMM2 –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–∏–π –∑–∞ OLS/CSS
–Ø–∫—â–æ g = 1: –æ–¥–Ω–∞–∫–æ–≤–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å (—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª)
```

**–ù–∞—à –≤–∏–ø–∞–¥–æ–∫ (gamma innovations):**
```
c‚ÇÉ = 0.8861  ‚Üí  g = 0.6995  ‚Üí  30% variance reduction
–ï–º–ø—ñ—Ä–∏—á–Ω–æ: 34% variance reduction ‚úì
```

---

## üìä –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

### –†–æ–∑–ø–æ–¥—ñ–ª–∏ –æ—Ü—ñ–Ω–æ–∫ (Monte Carlo)

–°—Ç–≤–æ—Ä—ñ—Ç—å –≥—Ä–∞—Ñ—ñ–∫–∏ —É R:
```r
library(ggplot2)

# –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ Monte Carlo
results <- read.csv("test_results/sma_monte_carlo_20251113_500reps.csv")

# –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ä–æ–∑–ø–æ–¥—ñ–ª—ñ–≤
ggplot(results) +
  geom_density(aes(x = css, fill = "CSS"), alpha = 0.5) +
  geom_density(aes(x = pmm2, fill = "PMM2"), alpha = 0.5) +
  geom_vline(xintercept = 0.6, linetype = "dashed", color = "red") +
  labs(title = "Distribution of Œ∏ estimates (500 replications)",
       x = "Estimated Œ∏", y = "Density") +
  theme_minimal()
```

### MSE –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è

```r
# –û–±—á–∏—Å–ª–∏—Ç–∏ MSE –¥–ª—è –∫–æ–∂–Ω–æ—ó —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ—ó
theta_true <- 0.6
results$mse_css <- (results$css - theta_true)^2
results$mse_pmm2 <- (results$pmm2 - theta_true)^2

# Boxplot
ggplot(results) +
  geom_boxplot(aes(x = "CSS", y = mse_css)) +
  geom_boxplot(aes(x = "PMM2", y = mse_pmm2)) +
  labs(title = "MSE Comparison", y = "Mean Squared Error") +
  theme_minimal()
```

---

## üõ†Ô∏è –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç—ñ–≤

### Quick Test (1 –ø—Ä–æ–≥–æ–Ω)

```r
# –£ R –∫–æ–Ω—Å–æ–ª—ñ
source("test_sma_quick.R")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ –∑ –æ–¥–Ω–∏–º –¥–∞—Ç–∞—Å–µ—Ç–æ–º.

### Monte Carlo Simulation (500 –ø—Ä–æ–≥–æ–Ω—ñ–≤)

```r
# –£ R –∫–æ–Ω—Å–æ–ª—ñ
source("run_sma_monte_carlo.R")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –î–µ—Ç–∞–ª—å–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω–∏–π –∞–Ω–∞–ª—ñ–∑
- CSV —Ñ–∞–π–ª –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ —É `test_results/`
- –¢—Ä–∏–≤–∞—î ~3-5 —Å–µ–∫—É–Ω–¥

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–∏–º—É–ª—è—Ü—ñ—ó

–í—ñ–¥—Ä–µ–¥–∞–≥—É–π—Ç–µ `run_sma_monte_carlo.R`:
```r
# –ó–º—ñ–Ω—ñ—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏:
n_sim <- 1000          # –ë—ñ–ª—å—à–µ —Ä–µ–ø–ª—ñ–∫–∞—Ü—ñ–π
n_obs <- 240           # –î–æ–≤—à—ñ —á–∞—Å–æ–≤—ñ —Ä—è–¥–∏
innovation_type <- "lognormal"  # –Ü–Ω—à–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª
```

---

## üìö –õ—ñ—Ç–µ—Ä–∞—Ç—É—Ä–∞ —Ç–∞ —Ç–µ–æ—Ä–µ—Ç–∏—á–Ω—ñ –æ—Å–Ω–æ–≤–∏

### –ú–µ—Ç–æ–¥ PMM

1. **Zabolotnii et al. (2018)** - Polynomial Maximization Method for parameter estimation
   DOI: 10.1007/978-3-319-77179-3_75

2. **Zabolotnii et al. (2022)** - Application to AR models
   DOI: 10.1007/978-3-031-03502-9_37

3. **Zabolotnii et al. (2023)** - Extension to ARMA models
   DOI: 10.1007/978-3-031-25844-2_21

### –°–µ–∑–æ–Ω–Ω—ñ —á–∞—Å–æ–≤—ñ —Ä—è–¥–∏

4. **Box & Jenkins (1976)** - Time Series Analysis: Forecasting and Control
   (–æ—Å–Ω–æ–≤–∏ SARIMA –º–æ–¥–µ–ª–µ–π)

5. **Hyndman & Athanasopoulos (2021)** - Forecasting: Principles and Practice
   (—Å—É—á–∞—Å–Ω—ñ –º–µ—Ç–æ–¥–∏ –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è)

---

## üöß –ú–∞–π–±—É—Ç–Ω—ñ–π —Ä–æ–∑–≤–∏—Ç–æ–∫

### –í —Ä–æ–∑—Ä–æ–±—Ü—ñ

- [ ] `predict.SMAPMM2` ‚Äî –ø—Ä–æ–≥–Ω–æ–∑—É–≤–∞–Ω–Ω—è –¥–ª—è SMA –º–æ–¥–µ–ª–µ–π
- [ ] Bootstrap inference –¥–ª—è SMA-PMM2
- [ ] –î—ñ–∞–≥–Ω–æ—Å—Ç–∏—á–Ω—ñ –≥—Ä–∞—Ñ—ñ–∫–∏ (ACF/PACF –∑–∞–ª–∏—à–∫—ñ–≤)
- [ ] AIC/BIC –¥–ª—è –≤–∏–±–æ—Ä—É –ø–æ—Ä—è–¥–∫—É –º–æ–¥–µ–ª—ñ

### –ó–∞–ø–ª–∞–Ω–æ–≤–∞–Ω–æ

- [ ] SARIMA-PMM2 (–∫–æ–º–±—ñ–Ω–∞—Ü—ñ—è SAR + SMA)
- [ ] Mult ivariate SMA models
- [ ] –†–µ–∞–ª—å–Ω—ñ –¥–∞—Ç–∞—Å–µ—Ç–∏ —Ç–∞ case studies
- [ ] –ü—É–±–ª—ñ–∫–∞—Ü—ñ—è —Å—Ç–∞—Ç—Ç—ñ

---

## ü§ù –ö–æ–Ω—Ç—Ä–∏–±—É—Ü—ñ—è

–Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–æ–∫—Ä–∞—â–∏—Ç–∏ SMA-PMM2:

1. **–ë–∞–≥-—Ä–µ–ø–æ—Ä—Ç–∏:** https://github.com/SZabolotnii/EstemPMM/issues
2. **Feature requests:** —Å—Ç–≤–æ—Ä—ñ—Ç—å issue –∑ –æ–ø–∏—Å–æ–º
3. **Pull requests:** –≤—ñ—Ç–∞—é—Ç—å—Å—è!

---

## üìû –ö–æ–Ω—Ç–∞–∫—Ç–∏

**–ê–≤—Ç–æ—Ä:** Serhii Zabolotnii
**Email:** zabolotniua@gmail.com
**ORCID:** 0000-0003-0242-2234
**GitHub:** https://github.com/SZabolotnii/EstemPMM

---

## üìù –õ—ñ—Ü–µ–Ω–∑—ñ—è

GPL-3 (–¥–∏–≤. LICENSE —Ñ–∞–π–ª)

---

## üôè –ü–æ–¥—è–∫–∏

- –ö–æ–º–∞–Ω–¥—ñ R Core –∑–∞ `stats::arima()`
- –†–æ–∑—Ä–æ–±–Ω–∏–∫–∞–º devtools/roxygen2 –∑–∞ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏
- Claude AI –∑–∞ –∞—Å–∏—Å—Ç—É–≤–∞–Ω–Ω—è –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ

---

**–°—Ç–≤–æ—Ä–µ–Ω–æ:** 13 –ª–∏—Å—Ç–æ–ø–∞–¥–∞ 2025
**–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:** 13 –ª–∏—Å—Ç–æ–ø–∞–¥–∞ 2025
**–í–µ—Ä—Å—ñ—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0
