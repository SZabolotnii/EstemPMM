# Звіт про Монте-Карло для сезонних моделей (PMM2 vs CSS)
**Дата запуску:** 2025-11-14  
**Гілка / коміт:** claude/pmm2-unified-model-s-011CV69DUEZCwHHfxTtR7jGu @ 22832ff  
**Сценарії:** SAR, SMA, SARMA, SARIMA (сезонність s = 12)  
**Реплікацій:** 500 на кожен сценарій  
**Розміри вибірки:** n ∈ {100, 200, 500}

---

## 1. Короткий підсумок
- У всіх сценаріях без сезонного диференціювання PMM2 стабільно зменшує дисперсію оцінок та має 100% конвергенції.
- Для SAR(1,1)_12 PMM2 знижує дисперсію оцінок φ та Φ у середньому на ~41%.
- Для SMA(1)_12 PMM2 дає від 14% до 24% виграшу у дисперсії при γ-розподілених інноваціях.
- Комбінована модель SARMA(1,0)×(1,1)_12 демонструє найбільший приріст для сезонних коефіцієнтів (до 98% зменшення дисперсії Φ та Θ).
- SARIMA(1,1,0)×(1,1,1)_12 зі строгим сезонним диференціюванням лишається «важким» кейсом: PMM2 покращує AR-частину, але програє CSS на сезонних коефіцієнтах через нестабільність оцінювання сезонної MA.
- Середній теоретичний фактор виграшу `g` для асиметричних інновацій тримається на рівні 0.58–0.62, що узгоджується з формулою `g = 1 - c3^2 / (2 + c4)`.

---

## 2. Деталізація за сценаріями

### 2.1 SAR(1,1)_12 (γ-інновації)
| n | RMSE CSS φ | RMSE PMM2 φ | ΔVar φ | RMSE CSS Φ | RMSE PMM2 Φ | ΔVar Φ |
|---|------------|-------------|--------|------------|-------------|--------|
|100|0.0590|0.0436|+40.9%|0.0591|0.0451|+39.3%|
|200|0.0298|0.0233|+36.7%|0.0343|0.0271|+36.5%|
|500|0.0162|0.0122|+43.0%|0.0189|0.0141|+44.1%|

- Середній `g`: 0.583 (n=100) → 0.590 (n=500).
- Конвергенція PMM2: 100% у всіх вибірках, без відхилених реплікацій.

### 2.2 SMA(1)_12
| n | RMSE CSS Θ | RMSE PMM2 Θ | ΔVar |
|---|-------------|--------------|------|
|100|0.0934|0.0827|+24.0%|
|200|0.0634|0.0563|+24.3%|
|500|0.0363|0.0337|+14.3%|

- PMM2 стабільно зменшує як RMSE, так і дисперсію оцінки сезонної MA.
- Середній `g`: 0.619 → 0.596 (ефект поступово зменшується із ростом n).

### 2.3 SARMA(1,0)×(1,1)_12
Відсотки відповідають (AR, SAR, SMA):
| n | ΔVar (%) |
|---|----------|
|100|+2.4%, +95.3%, +94.0%|
|200|+43.8%, +97.3%, +96.9%|
|500|+33.5%, +98.7%, +98.2%|

- Сезонні коефіцієнти отримують найбільший виграш; середній `g` = 0.576–0.592.

### 2.4 SARIMA(1,1,0)×(1,1,1)_12
| n | ΔVar φ | ΔVar Φ | ΔVar Θ |
|---|--------|--------|--------|
|100|-0.5%|-15.9%|-127.8%|
|200|+9.3%|-21.3%|-223.1%|
|500|+7.8%|-20.6%|-354.1%|

- Позитивний ефект зберігається лише для несезонного AR-коефіцієнта.
- Сезонні AR/MA оцінки деградують через нестійкі початкові значення `stats::arima` та високу вибіркову шумність після подвійного диференціювання.
- Середній `g` падає з 0.733 до 0.659, що вказує на втрату асиметрії після диференціювання.

---

## 3. Технічні деталі
- Команда: `Rscript monte_carlo_seasonal_comparison.R`.
- Тривалість: ~8 хв (Apple M4, 500×4 сценарії).
- Збережені артефакти:
  - `monte_carlo_seasonal_results.rds` — повний набір результатів.
  - `test_results/SAR_MONTE_CARLO_REPORT_2025-11-14.md` — цей звіт.
- Попередження: `stats::arima` згенерував >50 попереджень у SARIMA-сценарії через неінвертовні сезонні MA; усі реплікації завершені, але інтерпретацію сезонних коефіцієнтів слід робити обережно.

---

## 4. Рекомендації
1. **SAR/SMA/SARMA:** результати готові до публікації в README/NEWS; варто додати таблиці з цього звіту до англійської та української документації.
2. **SARIMA:** дослідити іншу ініціалізацію сезонних MA (CSS → Kalman) або додаткову регуляризацію перед наступним Монте-Карло.
3. **Аналітика:** побудувати графіки `ΔVar` та `g(n)` для інтерактивної візуалізації (див. `docs/`).
