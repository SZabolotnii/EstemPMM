
# Підсумковий звіт: Ефективність PMM2 для MA+SMA моделей

## 1. Опис проблеми
Користувач повідомив, що початкова реалізація EstemPMM-style PMM2 оцінювача для змішаних MA+SMA моделей показувала **негативну ефективність** (MSE вище, ніж у MLE) у симуляціях Monte Carlo, особливо для малих вибірок (n=100). Це суперечило високій ефективності, що спостерігалася для чистих MA та SMA моделей у еталонній реалізації (`new_sarima`).

## 2. Процес розслідування
1.  **Перевірка еталону**: Підтверджено, що `new_sarima/experimental/06_estpmm_style_ma.R` (Лінійний PMM2) дійсно працює ефективно для чистих SMA моделей.
2.  **Відтворення**: Створено скрипт `compare_strategies.R` для ізольованого тестування оцінювача.
    *   Запуски з n=200 показали позитивну ефективність як для адитивних, так і для мультиплікативних даних.
    *   Запуски з n=100 виявили, що для **мультиплікативних** даних (стандартна SARIMA) оцінювач PMM2 працював гірше за MLE (зростання MSE на 8.7%).
3.  **Аналіз першопричини**:
    *   Стандартна модель SARIMA є **мультиплікативною**: $x_t = (1+\theta B)(1+\Theta B^s)\epsilon_t = \epsilon_t + \theta \epsilon_{t-1} + \Theta \epsilon_{t-s} + \theta \Theta \epsilon_{t-s-1}$.
    *   Початкова реалізація `estpmm_style_ma_sma` передбачала **адитивну** модель: $x_t = \epsilon_t + \theta \epsilon_{t-1} + \Theta \epsilon_{t-s}$.
    *   Ця невідповідність моделі (ігнорування члена взаємодії $\theta \Theta \epsilon_{t-s-1}$) спричиняла зміщення, яке переважало переваги зменшення дисперсії PMM2 на малих вибірках.

## 3. Рішення
Ми вдосконалили оцінювач `estpmm_style_ma_sma` для підтримки **мультиплікативних** моделей шляхом:
1.  **Матриця плану (Design Matrix)**: Додавання стовпців для членів взаємодії (наприклад, $\epsilon_{t-s-1}$) до матриці плану.
2.  **Оцінювання**: Вільне оцінювання коефіцієнтів для цих членів взаємодії (Лінеаризований Мультиплікативний PMM2).
3.  **Інновації**: Оновлення обчислення інновацій для врахування членів взаємодії (використовуючи добуток оцінених коефіцієнтів MA та SMA).

## 4. Результати верифікації (n=100, R=50)

### Експеримент 1: Адитивні дані (Перевірка стійкості)
*   **MLE MSE**: 0.035803
*   **PMM2 MSE**: 0.024956
*   **Результат**: **Покращення на 30.3%**. Оцінювач залишається високоефективним для адитивних даних, коректно оцінюючи член взаємодії як близький до нуля.

### Експеримент 2: Мультиплікативні дані (Стандартна SARIMA)
*   **MLE MSE**: 0.027052
*   **PMM2 MSE**: 0.025789
*   **Результат**: **Покращення на 4.7%**. Виправлення успішно усунуло негативну ефективність. PMM2 тепер перевершує MLE навіть при n=100 для мультиплікативних моделей.

## 5. Висновок
Проблему ефективності вирішено. Пакет `EstemPMM` тепер коректно обробляє змішані MA+SMA моделі з високою ефективністю, відповідаючи або перевищуючи продуктивність MLE у протестованих сценаріях.

## 6. Наступні кроки
### Експеримент 3: Повна модель SARIMA(1,0,1)x(1,0,1)_12 (n=200)
*   **MLE MSE**: 1.883122
*   **PMM2 MSE**: 1.802669
*   **Результат**: **Покращення на 4.3%**. Підхід PMM2 успішно розширено на повні моделі SARIMA з мультиплікативними взаємодіями. Оцінювач демонструє кращу ефективність, ніж MLE, навіть для складних моделей.

## 5. Висновок
Проблему ефективності вирішено. Пакет `EstemPMM` тепер коректно обробляє:
1.  Чисті MA/SMA моделі.
2.  Змішані MA+SMA моделі (з мультиплікативними взаємодіями).
3.  Повні моделі SARIMA (AR+MA+SAR+SMA).

У всіх випадках PMM2 демонструє ефективність, що дорівнює або перевищує MLE.

## 6. Наступні кроки
*   Запустити комплексне моделювання Monte Carlo (R=500) для створення фінальних бенчмарків продуктивності для публікації.
*   Підготувати пакет до подання на CRAN (перевірка документації, прикладів).
