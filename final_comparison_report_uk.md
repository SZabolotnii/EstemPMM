# Порівняльний аналіз підходів PMM2 для оцінювання параметрів

## 1. Вступ
Цей звіт містить розширений порівняльний аналіз трьох підходів до реалізації методу PMM2 для оцінювання параметрів регресійних моделей (зокрема SARIMA) з негаусовими помилками.

## 2. Опис підходів

### 1. Linearized PMM2 (Specific)
*   **Опис**: Спеціалізована реалізація для MA/SMA моделей, що використовує явну побудову матриці плану з фіксованих залишків.
*   **Статус**: Високоефективна, але обмежена класом моделей (тільки чисті MA або SMA).

### 2. Direct Nonlinear PMM2 (Optimized)
*   **Опис**: Спроба прямої чисельної максимізації критерію PMM2 ($J = \gamma_3^2 / (2+\gamma_4)$) за допомогою градієнтних методів (BFGS/L-BFGS-B) з аналітичними похідними.
*   **Статус**: Експериментальна.

### 3. Unified PMM2 (Iterative & One-step)
*   **Опис**: Універсальний розв'язувач, що використовує ітеративну процедуру Ньютона-Рафсона (або Scoring) для оновлення параметрів на основі локальної квадратичної апроксимації цільової функції. Підтримує будь-які моделі через інтерфейс залишків та Якобіана.
*   **Статус**: Основний кандидат на впровадження.

## 3. Результати симуляції Monte Carlo
Параметри: $R=50$, $n=200$, помилки: зміщений $\chi^2(3)$.

| Model | MLE (MSE) | Unified One-step | Unified Iterative | Linearized (Specific) | Direct Nonlinear |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **AR(1)** | 0.0465 | 0.0455 (-2.2%) | **0.0452 (-2.9%)** | *N/A* | *N/A* |
| **MA(1)** | 0.0028 | **0.0021 (-23.0%)** | 0.0022 (-19.9%) | **0.0022 (-21.6%)** | 721.78 (Fail) |
| **SARIMA** | 0.0285 | 0.0241 (-15.6%) | **0.0239 (-16.4%)** | *N/A* | 1565.79 (Fail) |

## 4. Аналіз результатів

1.  **Unified PMM2 (Переможець)**:
    *   Демонструє стабільне покращення над MLE у всіх сценаріях (від 3% до 23%).
    *   **Iterative** версія дає найкращі результати для складних моделей (SARIMA).
    *   **One-step** версія є надзвичайно ефективною та швидкою, майже не поступаючись ітеративній.

2.  **Linearized PMM2**:
    *   Для MA(1) показав результат, ідентичний Unified PMM2. Це підтверджує коректність математичної моделі уніфікованого підходу.
    *   Обмежений у застосуванні (складно розширити на змішані моделі).

3.  **Direct Nonlinear PMM2**:
    *   **Провал**. Навіть з аналітичними градієнтами та обмеженнями (L-BFGS-B), метод виявився вкрай нестабільним.
    *   Причина: Поверхня цільової функції PMM2 є складною, з багатьма локальними екстремумами та "плоскими" ділянками, що робить пряму оптимізацію ненадійною порівняно з ітеративним розв'язанням системи рівнянь (як у Unified/Linearized).

## 5. Рекомендації

1.  **Відмовитися від Direct Nonlinear PMM2** як основного методу. Його можна залишити лише для глибоких досліджень теоретичних властивостей поверхні.
2.  **Впровадити Unified PMM2** як основний двигун пакету `EstemPMM`.
    *   Він універсальний (підтримує AR, MA, SARIMA, Regression).
    *   Він стабільний та ефективний.
3.  **Використовувати чисельний Якобіан** (через `numDeriv` або аналоги) для забезпечення підтримки широкого класу моделей без необхідності виводити формули вручну для кожного нового типу.
